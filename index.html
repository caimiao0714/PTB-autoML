<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Preterm birth prediction using 3 AutoML frameworks: AutoGluon, H2O AutoML, and Autosklearn</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#environment-set-up" id="toc-environment-set-up" class="nav-link active" data-scroll-target="#environment-set-up"><span class="header-section-number">1</span> Environment set up</a></li>
  <li><a href="#data-import" id="toc-data-import" class="nav-link" data-scroll-target="#data-import"><span class="header-section-number">2</span> Data import</a></li>
  <li><a href="#autogluon" id="toc-autogluon" class="nav-link" data-scroll-target="#autogluon"><span class="header-section-number">3</span> AutoGluon</a>
  <ul class="collapse">
  <li><a href="#train-data-using-autogluon" id="toc-train-data-using-autogluon" class="nav-link" data-scroll-target="#train-data-using-autogluon"><span class="header-section-number">3.1</span> Train data using AutoGluon</a></li>
  <li><a href="#predictive-performance-on-training-set" id="toc-predictive-performance-on-training-set" class="nav-link" data-scroll-target="#predictive-performance-on-training-set"><span class="header-section-number">3.2</span> predictive performance on training set</a></li>
  <li><a href="#predictive-performance-on-testing-set" id="toc-predictive-performance-on-testing-set" class="nav-link" data-scroll-target="#predictive-performance-on-testing-set"><span class="header-section-number">3.3</span> predictive performance on testing set</a></li>
  <li><a href="#feature-importance-on-testing-data" id="toc-feature-importance-on-testing-data" class="nav-link" data-scroll-target="#feature-importance-on-testing-data"><span class="header-section-number">3.4</span> Feature importance on testing data</a></li>
  </ul></li>
  <li><a href="#h2o-automl" id="toc-h2o-automl" class="nav-link" data-scroll-target="#h2o-automl"><span class="header-section-number">4</span> H2O AutoML</a>
  <ul class="collapse">
  <li><a href="#configuring-h2o-automl" id="toc-configuring-h2o-automl" class="nav-link" data-scroll-target="#configuring-h2o-automl"><span class="header-section-number">4.1</span> Configuring H2O AutoML</a></li>
  <li><a href="#convert-data-into-h2o-frames" id="toc-convert-data-into-h2o-frames" class="nav-link" data-scroll-target="#convert-data-into-h2o-frames"><span class="header-section-number">4.2</span> Convert data into H2O Frames</a></li>
  <li><a href="#train-data-using-h2o-automl" id="toc-train-data-using-h2o-automl" class="nav-link" data-scroll-target="#train-data-using-h2o-automl"><span class="header-section-number">4.3</span> Train data using H2O AutoML</a></li>
  <li><a href="#leaderboard" id="toc-leaderboard" class="nav-link" data-scroll-target="#leaderboard"><span class="header-section-number">4.4</span> Leaderboard</a></li>
  <li><a href="#turn-off-h2o-cluster" id="toc-turn-off-h2o-cluster" class="nav-link" data-scroll-target="#turn-off-h2o-cluster"><span class="header-section-number">4.5</span> Turn off H2O cluster</a></li>
  </ul></li>
  <li><a href="#auto-sklearn" id="toc-auto-sklearn" class="nav-link" data-scroll-target="#auto-sklearn"><span class="header-section-number">5</span> Auto-sklearn</a>
  <ul class="collapse">
  <li><a href="#set-up-auto-sklearn-environment" id="toc-set-up-auto-sklearn-environment" class="nav-link" data-scroll-target="#set-up-auto-sklearn-environment"><span class="header-section-number">5.1</span> Set up auto-sklearn environment</a></li>
  <li><a href="#set-up-data-for-auto-sklearn" id="toc-set-up-data-for-auto-sklearn" class="nav-link" data-scroll-target="#set-up-data-for-auto-sklearn"><span class="header-section-number">5.2</span> Set up data for auto-sklearn</a></li>
  <li><a href="#auto-sklearn-model-fitting" id="toc-auto-sklearn-model-fitting" class="nav-link" data-scroll-target="#auto-sklearn-model-fitting"><span class="header-section-number">5.3</span> Auto-sklearn model fitting</a></li>
  <li><a href="#summarize-results" id="toc-summarize-results" class="nav-link" data-scroll-target="#summarize-results"><span class="header-section-number">5.4</span> Summarize results</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Preterm birth prediction using 3 AutoML frameworks: AutoGluon, H2O AutoML, and Autosklearn</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="environment-set-up" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Environment set up</h1>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autogluon.tabular <span class="im">import</span> TabularPredictor</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> datatable <span class="im">as</span> dt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> textwrap</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">## Get Version information</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(textwrap.fill(sys.version),<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"pandas version: </span><span class="sc">{0}</span><span class="st">"</span>.<span class="bu">format</span>(pd.__version__))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"datatable version: </span><span class="sc">{0}</span><span class="st">"</span>.<span class="bu">format</span>(dt.__version__))</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"datatable version: </span><span class="sc">{0}</span><span class="st">"</span>.<span class="bu">format</span>(dt.__version__))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"python path: </span><span class="sc">{0}</span><span class="st">"</span>.<span class="bu">format</span>(sys.executable))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\admin\.conda\envs\p38\lib\site-packages\scipy\__init__.py:155: UserWarning:

A NumPy version &gt;=1.18.5 and &lt;1.25.0 is required for this version of SciPy (detected version 1.26.2
</code></pre>
</div>
<div class="cell-output cell-output-display">

<style type="text/css">
.datatable table.frame { margin-bottom: 0; }
.datatable table.frame thead { border-bottom: none; }
.datatable table.frame tr.coltypes td {  color: #FFFFFF;  line-height: 6px;  padding: 0 0.5em;}
.datatable .bool    { background: #DDDD99; }
.datatable .object  { background: #565656; }
.datatable .int     { background: #5D9E5D; }
.datatable .float   { background: #4040CC; }
.datatable .str     { background: #CC4040; }
.datatable .time    { background: #40CC40; }
.datatable .row_index {  background: var(--jp-border-color3);  border-right: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  font-size: 9px;}
.datatable .frame tbody td { text-align: left; }
.datatable .frame tr.coltypes .row_index {  background: var(--jp-border-color0);}
.datatable th:nth-child(2) { padding-left: 12px; }
.datatable .hellipsis {  color: var(--jp-cell-editor-border-color);}
.datatable .vellipsis {  background: var(--jp-layout-color0);  color: var(--jp-cell-editor-border-color);}
.datatable .na {  color: var(--jp-cell-editor-border-color);  font-size: 80%;}
.datatable .sp {  opacity: 0.25;}
.datatable .footer { font-size: 9px; }
.datatable .frame_dimensions {  background: var(--jp-border-color3);  border-top: 1px solid var(--jp-border-color0);  color: var(--jp-ui-font-color3);  display: inline-block;  opacity: 0.6;  padding: 1px 10px 1px 5px;}
.datatable .frame thead tr.colnames {  background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAA4CAYAAADuMJi0AAAGR0lEQVR42rVZ21IbRxBtCbQrkIR2dQVjsLmDLBsET3nTQ8ouYRkQVf6e/E9+Im958qMfkgoXAaKSSj6C9Jnd2R2NeiRSRaZqitVOT5+Z6dNnWoKGlN94JFp8Ipofkb/7SOXjGyp8wF+z35K3f0uUp/GW4XfLQ8v2gefj3ZCCzojoNfue+43o1Q3l3xB/yA3JO7jnF2pCLnI+pNyx/qw7L+SQ7T2N9p2f8c60QcfcK6KGXsAd+ZvA4LlZYuSSAoOhMs5vwJkEGDlbPMaJoA+FcQ0IH38QLWkbAFLkOOhoMF5tU6/eBRhNjro0ZgKiPRAt3FLhCO/vqdgmNTm32LkmKpvBmQY4q5uAaAgbwDBG2BVv3bfI8KKAMWj2kfw9+pkZREIbEql4ST1x7hgHIANkbJ//MF8mAH/ilTCJ2tIi4ASr1IC3VNqXHKOxjy34mgoImnOQtx1g81fkqTiMOBVGcTogNhiT5iBHET8R8C+iApJUmgim3SQAXhsLQz7ee2G8gOAQNtJckBEplADiAxtX+G9NmhDl0qJKnTvyWlAMPYZnvIviGXRg6/Dh824DBXhP/tbfREXJEIvQ+aaPGjG7pvw6r3xdx+9hqb4dgZaP2XmdHO2K/B0c1+oUph6k8kShBryl/Ft0DYgjTlOieOACHFFpVyUl72T9V3cM1jUoYvxIC2vpCSys/ck70mDYuYvdvKjlMdKAUThneWVU1aAsyjv6PURDiwNsHGBZzY+JtAAgE2TFxdRHJdyIp/f+zqu09M5cDP2F08Ukkpj4YNSdX950HY2pNCCUK/Hhx5ZMBfjNSEzdsIihVzzAMdn9dz4eDYhnyQb9SSCiAryiJcQk82LiTbJ4x2FZJaUenpKnzP95WyDf4Y+QN9EFHHSeDLGdBjjKNQ5vKHf4XMA7KrY0y0GEObBOO/8e1ywuQExOHXktuQyJALEBpcEqhwtHqgiDuCK5b6i0p2MQpcckIIoh+6hYgTZtO8xlMi6O4tKCF/kOGHEg/W0UUpHW0ZoGNZ1ExZWcn7EErgwt4uj50E/sFBjXXIayWvh7WryjasxarZKssXon0zxvvkc32Q0bqbBCuZiKt9dWFysfQefeL29JYFaeztX6tePaZdz5mYx8+6Zq3Mk0wXECQxlhdzgS2wjBHju3j1RIgKyOMdNUE8X0+RAdbSapS11MRCv1SzUXmO6wGZe2SQYrv2MvCSWEv2VODE6DN7bz8ufypgQKW7uQskFTQHULLKyaEyrnlZbgOGLrV5qrn9U79jjm2HJmgkaVN98AfBub91lGPLZBqdroN5LYgjSu4zYZDDHXZOIPC691HqrWI1900I8qLzgKP4ft8DxEWigprPfrO+KcXno9gZz4jjGewWdUcpGCj0qVFuGPYbl2VturndZ2qRvlL8acDO6lF/DY/VjsFesiUK+ypJ+r/ep+cJkSQxEK4PG4WozgA75TYrDDqStE69K8/mzGEM+JXTeqvmedEElMmwCMm2SLd6bNNF9su02zEtoW6nAQtpMj5Gd7fKa//wqonF7UdtHFsVn+6hf1o7AfriPH7M6EeIUEF5zKVxXbYo7kS/OEtOqDYZKPoBsETIixn0uYrasThmzDkhdKPkz2EnaX0HdQbIgr59vAdGYDqjHrxkjS7WOxkTD8sqEqhiwcJETgBYigrBqF08KyDaje9SZ/I1A7MzaTzMGDEulPtZUkuKcyIRAjxEJPVrnVlb/9wkfij31D/pQt1IN+iL8bGJcstBIO7Y5VI/cwDqURbXhMuJxBqD0KLoK3esWFs0Jz5i5ZvJUAfFJMFb9XmGIOnzGpijpcWYCaMqXSQWp8EnCABepQ0Elyi4wfKfsw78ikIqif1pe1AGPlLmojl1SKxHHXp1L+Ut7AmDQHvhI5xHGi4EooO2BR7k78PEkJOdL7cAxQUZ/Tyclu9gnfwGgOmm2lNHGNmZXsq4Pqgc1EG1ATrvKl8s4R9ywwnqulGUnaRLVhxy8v3ieUwy2hbooT68uscW++DCDH0WSzuoyN2D4LUJ/tLECbcSKznwMIFs0ChF4mRTCnQbIIfk4SHJo6A9BMuTnXTs3Ku/KxsgZWqzuSe+Os8cEUfnMBY6UF5gi3SUbd5K7vDjq5WW0UENJlRsWn4sy21Er/E/AvPQSFHy1p4fgAAAAASUVORK5CYII=');  background-repeat: repeat-x;  background-size: 14px;  height: 28px;}
</style>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>3.9.18 | packaged by conda-forge | (main, Aug 30 2023, 03:40:31) [MSC
v.1929 64 bit (AMD64)] 

pandas version: 2.1.3
datatable version: 1.1.0
datatable version: 1.1.0
python path: C:\Users\admin\.conda\envs\p38\python.exe</code></pre>
</div>
</div>
</section>
<section id="data-import" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Data import</h1>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>d <span class="op">=</span> pd.read_parquet(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">'Data/prom.parquet'</span>, </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  engine <span class="op">=</span> <span class="st">'fastparquet'</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>dl_train, dl_test <span class="op">=</span> train_test_split(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  d, test_size <span class="op">=</span> <span class="fl">0.25</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>dl_train.columns.tolist()</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="co"># run_time = 10*60*60</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>run_time <span class="op">=</span> <span class="dv">30</span> <span class="co"># run time in seconds</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Training data:</p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dl_train</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">ethnicity</th>
<th data-quarto-table-cell-role="th">occupation</th>
<th data-quarto-table-cell-role="th">marriage</th>
<th data-quarto-table-cell-role="th">payment_method</th>
<th data-quarto-table-cell-role="th">admission_status</th>
<th data-quarto-table-cell-role="th">admission_source</th>
<th data-quarto-table-cell-role="th">GDM</th>
<th data-quarto-table-cell-role="th">PROM</th>
<th data-quarto-table-cell-role="th">gestational_htn</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">elipse</th>
<th data-quarto-table-cell-role="th">qidai</th>
<th data-quarto-table-cell-role="th">Endometriosis</th>
<th data-quarto-table-cell-role="th">PTB</th>
<th data-quarto-table-cell-role="th">multifetal_preg</th>
<th data-quarto-table-cell-role="th">polyhydramnios</th>
<th data-quarto-table-cell-role="th">cervical_weakness</th>
<th data-quarto-table-cell-role="th">chromosomal_abnormalities</th>
<th data-quarto-table-cell-role="th">immune_disease</th>
<th data-quarto-table-cell-role="th">antiphospholipid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">11587</td>
<td>28.0</td>
<td>Han</td>
<td>Other</td>
<td>Married</td>
<td>NRCMS</td>
<td>Emergent</td>
<td>Outpatient</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">45435</td>
<td>24.0</td>
<td>Han</td>
<td>Other</td>
<td>Married</td>
<td>Self-payment</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">373180</td>
<td>28.0</td>
<td>Han</td>
<td>Farmer</td>
<td>Married</td>
<td>NRCMS</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">574107</td>
<td>22.0</td>
<td>Han</td>
<td>Farmer</td>
<td>Married</td>
<td>NRCMS</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34431</td>
<td>38.0</td>
<td>Han</td>
<td>Jobless</td>
<td>Married</td>
<td>NRCMS</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">259178</td>
<td>24.0</td>
<td>Han</td>
<td>Farmer</td>
<td>Married</td>
<td>NRCMS</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">365838</td>
<td>31.0</td>
<td>Han</td>
<td>Other</td>
<td>Married</td>
<td>Other</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">131932</td>
<td>24.0</td>
<td>Han</td>
<td>Private institution</td>
<td>Married</td>
<td>NRCMS</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">671155</td>
<td>28.0</td>
<td>Han</td>
<td>Jobless</td>
<td>Married</td>
<td>URBMI</td>
<td>Emergent</td>
<td>Outpatient</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">121958</td>
<td>25.0</td>
<td>Han</td>
<td>Private institution</td>
<td>Married</td>
<td>Other</td>
<td>Dangerous</td>
<td>Emergency department</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>536971 rows × 21 columns</p>
</div>
</div>
</div>
<p>Testing data:</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dl_test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">ethnicity</th>
<th data-quarto-table-cell-role="th">occupation</th>
<th data-quarto-table-cell-role="th">marriage</th>
<th data-quarto-table-cell-role="th">payment_method</th>
<th data-quarto-table-cell-role="th">admission_status</th>
<th data-quarto-table-cell-role="th">admission_source</th>
<th data-quarto-table-cell-role="th">GDM</th>
<th data-quarto-table-cell-role="th">PROM</th>
<th data-quarto-table-cell-role="th">gestational_htn</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">elipse</th>
<th data-quarto-table-cell-role="th">qidai</th>
<th data-quarto-table-cell-role="th">Endometriosis</th>
<th data-quarto-table-cell-role="th">PTB</th>
<th data-quarto-table-cell-role="th">multifetal_preg</th>
<th data-quarto-table-cell-role="th">polyhydramnios</th>
<th data-quarto-table-cell-role="th">cervical_weakness</th>
<th data-quarto-table-cell-role="th">chromosomal_abnormalities</th>
<th data-quarto-table-cell-role="th">immune_disease</th>
<th data-quarto-table-cell-role="th">antiphospholipid</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">52546</td>
<td>25.0</td>
<td>Han</td>
<td>Other</td>
<td>Married</td>
<td>Other</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">187115</td>
<td>32.0</td>
<td>Han</td>
<td>Farmer</td>
<td>Married</td>
<td>URBMI</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">213978</td>
<td>43.0</td>
<td>Han</td>
<td>Other</td>
<td>Married</td>
<td>NRCMS</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">116761</td>
<td>24.0</td>
<td>Han</td>
<td>Farmer</td>
<td>Married</td>
<td>Other</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">617240</td>
<td>27.0</td>
<td>Han</td>
<td>Other</td>
<td>Married</td>
<td>NRCMS</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">370338</td>
<td>23.0</td>
<td>Han</td>
<td>Farmer</td>
<td>Married</td>
<td>NRCMS</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">288442</td>
<td>26.0</td>
<td>Han</td>
<td>Other</td>
<td>Married</td>
<td>UEBMI</td>
<td>Emergent</td>
<td>Outpatient</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">684193</td>
<td>35.0</td>
<td>Han</td>
<td>Jobless</td>
<td>Unmarried</td>
<td>Self-payment</td>
<td>Normal</td>
<td>Other medical facilities</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">651903</td>
<td>38.0</td>
<td>Han</td>
<td>Farmer</td>
<td>Married</td>
<td>NRCMS</td>
<td>Dangerous</td>
<td>Emergency department</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">213416</td>
<td>24.0</td>
<td>Han</td>
<td>Other</td>
<td>Married</td>
<td>NRCMS</td>
<td>Emergent</td>
<td>Outpatient</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>

<p>178991 rows × 21 columns</p>
</div>
</div>
</div>
</section>
<section id="autogluon" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> AutoGluon</h1>
<section id="train-data-using-autogluon" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="train-data-using-autogluon"><span class="header-section-number">3.1</span> Train data using AutoGluon</h2>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>predictor <span class="op">=</span> TabularPredictor(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  label <span class="op">=</span> <span class="st">'PTB'</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  problem_type <span class="op">=</span> <span class="st">'binary'</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  path <span class="op">=</span> <span class="st">'Models/Autogluon_PTB/'</span>, </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  eval_metric <span class="op">=</span> <span class="st">'roc_auc'</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>).fit(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    train_data <span class="op">=</span> dl_train, </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    auto_stack <span class="op">=</span> <span class="va">True</span>,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    time_limit <span class="op">=</span> run_time, </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    ag_args_fit<span class="op">=</span>{<span class="st">'num_gpus'</span>: <span class="dv">1</span>})</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">#predictor.fit_summary(show_plot=True)</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> predictor.fit_summary()  <span class="co"># display detailed summary of fit() process</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: path already exists! This predictor may overwrite an existing predictor! path="Models/Autogluon_PTB/"
No presets specified! To achieve strong results with AutoGluon, it is recommended to use the available presets.
    Recommended Presets (For more details refer to https://auto.gluon.ai/stable/tutorials/tabular/tabular-essentials.html#presets):
    presets='best_quality'   : Maximize accuracy. Default time_limit=3600.
    presets='high_quality'   : Strong accuracy with fast inference speed. Default time_limit=3600.
    presets='good_quality'   : Good accuracy with very fast inference speed. Default time_limit=3600.
    presets='medium_quality' : Fast training time, ideal for initial prototyping.
Stack configuration (auto_stack=True): num_stack_levels=0, num_bag_folds=8, num_bag_sets=5
Beginning AutoGluon training ... Time limit = 30s
AutoGluon will save models to "Models/Autogluon_PTB/"
=================== System Info ===================
AutoGluon Version:  1.0.0
Python Version:     3.9.18
Operating System:   Windows
Platform Machine:   AMD64
Platform Version:   10.0.19045
CPU Count:          12
Memory Avail:       4.52 GB / 13.91 GB (32.5%)
Disk Space Avail:   183.14 GB / 465.14 GB (39.4%)
===================================================
Train Data Rows:    536971
Train Data Columns: 20
Label Column:       PTB
Problem Type:       binary
Preprocessing data ...
Selected class &lt;--&gt; label mapping:  class 1 = 1, class 0 = 0
Using Feature Generators to preprocess the data ...
Fitting AutoMLPipelineFeatureGenerator...
    Available Memory:                    4793.21 MB
    Train Data (Original)  Memory Usage: 260.37 MB (5.4% of available memory)
    Warning: Data size prior to feature transformation consumes 5.4% of available memory. Consider increasing memory or subsampling the data to avoid instability.
    Inferring data type of each feature based on column values. Set feature_metadata_in to manually specify special dtypes of the features.
    Stage 1 Generators:
        Fitting AsTypeFeatureGenerator...
            Note: Converting 13 features to boolean dtype as they only contain 2 unique values.
    Stage 2 Generators:
        Fitting FillNaFeatureGenerator...
    Stage 3 Generators:
        Fitting IdentityFeatureGenerator...
        Fitting CategoryFeatureGenerator...
            Fitting CategoryMemoryMinimizeFeatureGenerator...
    Stage 4 Generators:
        Fitting DropUniqueFeatureGenerator...
    Stage 5 Generators:
        Fitting DropDuplicatesFeatureGenerator...
    Useless Original Features (Count: 1): ['immune_disease']
        These features carry no predictive signal and should be manually investigated.
        This is typically a feature which has the same value for all rows.
        These features do not need to be present at inference time.
    Unused Original Features (Count: 4): ['Endometriosis', 'multifetal_preg', 'chromosomal_abnormalities', 'antiphospholipid']
        These features were not used to generate any of the output features. Add a feature generator compatible with these features to utilize them.
        Features can also be unused if they carry very little information, such as being categorical but having almost entirely unique values or being duplicates of other features.
        These features do not need to be present at inference time.
        ('float', []) : 4 | ['Endometriosis', 'multifetal_preg', 'chromosomal_abnormalities', 'antiphospholipid']
    Types of features in original data (raw dtype, special dtypes):
        ('float', [])  : 9 | ['age', 'GDM', 'PROM', 'gestational_htn', 'uterine_fibroids', ...]
        ('object', []) : 6 | ['ethnicity', 'occupation', 'marriage', 'payment_method', 'admission_status', ...]
    Types of features in processed data (raw dtype, special dtypes):
        ('category', [])  : 5 | ['occupation', 'marriage', 'payment_method', 'admission_status', 'admission_source']
        ('float', [])     : 1 | ['age']
        ('int', ['bool']) : 9 | ['ethnicity', 'GDM', 'PROM', 'gestational_htn', 'uterine_fibroids', ...]
    1.9s = Fit runtime
    15 features in original data used to generate 15 features in processed data.
    Train Data (Processed) Memory Usage: 11.27 MB (0.2% of available memory)
Data preprocessing and feature engineering runtime = 1.99s ...
AutoGluon will gauge predictive performance using evaluation metric: 'roc_auc'
    This metric expects predicted probabilities rather than predicted class labels, so you'll need to use predict_proba() instead of predict()
    To change this, specify the eval_metric parameter of Predictor()
User-specified model hyperparameters to be fit:
{
    'NN_TORCH': {},
    'GBM': [{'extra_trees': True, 'ag_args': {'name_suffix': 'XT'}}, {}, 'GBMLarge'],
    'CAT': {},
    'XGB': {},
    'FASTAI': {},
    'RF': [{'criterion': 'gini', 'ag_args': {'name_suffix': 'Gini', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'entropy', 'ag_args': {'name_suffix': 'Entr', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'squared_error', 'ag_args': {'name_suffix': 'MSE', 'problem_types': ['regression', 'quantile']}}],
    'XT': [{'criterion': 'gini', 'ag_args': {'name_suffix': 'Gini', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'entropy', 'ag_args': {'name_suffix': 'Entr', 'problem_types': ['binary', 'multiclass']}}, {'criterion': 'squared_error', 'ag_args': {'name_suffix': 'MSE', 'problem_types': ['regression', 'quantile']}}],
    'KNN': [{'weights': 'uniform', 'ag_args': {'name_suffix': 'Unif'}}, {'weights': 'distance', 'ag_args': {'name_suffix': 'Dist'}}],
}
Fitting 13 L1 models ...
Fitting model: KNeighborsUnif_BAG_L1 ... Training model for up to 28.01s of the 28.01s of remaining time.
    Not enough time to generate out-of-fold predictions for model. Estimated time required was 229.88s compared to 35.67s of available time.
    Time limit exceeded... Skipping KNeighborsUnif_BAG_L1.
Fitting model: KNeighborsDist_BAG_L1 ... Training model for up to 25.19s of the 25.18s of remaining time.
    Not enough time to generate out-of-fold predictions for model. Estimated time required was 247.06s compared to 32.0s of available time.
    Time limit exceeded... Skipping KNeighborsDist_BAG_L1.
Fitting model: LightGBMXT_BAG_L1 ... Training model for up to 24.04s of the 24.04s of remaining time.
    Fitting 8 child models (S1F1 - S1F8) | Fitting with ParallelLocalFoldFittingStrategy (1.0 workers, per: cpus=1, gpus=1, memory=2.51%)
    0.8394   = Validation score   (roc_auc)
    35.11s   = Training   runtime
    0.62s    = Validation runtime
Completed 1/5 k-fold bagging repeats ...
Fitting model: WeightedEnsemble_L2 ... Training model for up to 28.01s of the -21.69s of remaining time.
    Ensemble Weights: {'LightGBMXT_BAG_L1': 1.0}
    0.8394   = Validation score   (roc_auc)
    0.06s    = Training   runtime
    0.05s    = Validation runtime
AutoGluon training complete, total runtime = 51.85s ... Best model: "WeightedEnsemble_L2"
TabularPredictor saved. To load, use: predictor = TabularPredictor.load("Models/Autogluon_PTB/")
C:\Users\admin\.conda\envs\p38\lib\site-packages\autogluon\core\utils\plots.py:169: UserWarning:

AutoGluon summary plots cannot be created because bokeh is not installed. To see plots, please do: "pip install bokeh==2.0.1"
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>*** Summary of fit() ***
Estimated performance of each model:
                 model  score_val eval_metric  pred_time_val   fit_time  pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  fit_order
0    LightGBMXT_BAG_L1   0.839358     roc_auc       0.618643  35.107029                0.618643          35.107029            1       True          1
1  WeightedEnsemble_L2   0.839358     roc_auc       0.669655  35.171043                0.051012           0.064014            2       True          2
Number of models trained: 2
Types of models trained:
{'StackerEnsembleModel_LGB', 'WeightedEnsembleModel'}
Bagging used: True  (with 8 folds)
Multi-layer stack-ensembling used: False 
Feature Metadata (Processed):
(raw dtype, special dtypes):
('category', [])  : 5 | ['occupation', 'marriage', 'payment_method', 'admission_status', 'admission_source']
('float', [])     : 1 | ['age']
('int', ['bool']) : 9 | ['ethnicity', 'GDM', 'PROM', 'gestational_htn', 'uterine_fibroids', ...]
*** End of fit() summary ***
{'model_types': {'LightGBMXT_BAG_L1': 'StackerEnsembleModel_LGB', 'WeightedEnsemble_L2': 'WeightedEnsembleModel'}, 'model_performance': {'LightGBMXT_BAG_L1': 0.8393580298960552, 'WeightedEnsemble_L2': 0.8393580298960552}, 'model_best': 'WeightedEnsemble_L2', 'model_paths': {'LightGBMXT_BAG_L1': ['LightGBMXT_BAG_L1'], 'WeightedEnsemble_L2': ['WeightedEnsemble_L2']}, 'model_fit_times': {'LightGBMXT_BAG_L1': 35.10702919960022, 'WeightedEnsemble_L2': 0.06401371955871582}, 'model_pred_times': {'LightGBMXT_BAG_L1': 0.6186428070068359, 'WeightedEnsemble_L2': 0.05101180076599121}, 'num_bag_folds': 8, 'max_stack_level': 2, 'num_classes': 2, 'model_hyperparams': {'LightGBMXT_BAG_L1': {'use_orig_features': True, 'max_base_models': 25, 'max_base_models_per_type': 5, 'save_bag_folds': True}, 'WeightedEnsemble_L2': {'use_orig_features': False, 'max_base_models': 25, 'max_base_models_per_type': 5, 'save_bag_folds': True}}, 'leaderboard':                  model  score_val eval_metric  pred_time_val   fit_time  \
0    LightGBMXT_BAG_L1   0.839358     roc_auc       0.618643  35.107029   
1  WeightedEnsemble_L2   0.839358     roc_auc       0.669655  35.171043   

   pred_time_val_marginal  fit_time_marginal  stack_level  can_infer  \
0                0.618643          35.107029            1       True   
1                0.051012           0.064014            2       True   

   fit_order  
0          1  
1          2  }</code></pre>
</div>
</div>
</section>
<section id="predictive-performance-on-training-set" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="predictive-performance-on-training-set"><span class="header-section-number">3.2</span> predictive performance on training set</h2>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#['roc_auc','accuracy','log_loss']</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ld_train <span class="op">=</span> predictor.leaderboard(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  data<span class="op">=</span>dl_train,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  extra_metrics<span class="op">=</span>[<span class="st">'roc_auc'</span>,<span class="st">'accuracy'</span>,<span class="st">'log_loss'</span>])</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Leaderboard on training set'</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ld_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Leaderboard on training set
                 model  score_test   roc_auc  accuracy  log_loss  score_val  \
0    LightGBMXT_BAG_L1    0.841484  0.841484  0.936129 -0.170856   0.839358   
1  WeightedEnsemble_L2    0.841484  0.841484  0.936129 -0.170856   0.839358   

  eval_metric  pred_time_test  pred_time_val   fit_time  \
0     roc_auc        1.535344       0.618643  35.107029   
1     roc_auc        1.543345       0.669655  35.171043   

   pred_time_test_marginal  pred_time_val_marginal  fit_time_marginal  \
0                 1.535344                0.618643          35.107029   
1                 0.008002                0.051012           0.064014   

   stack_level  can_infer  fit_order  
0            1       True          1  
1            2       True          2  </code></pre>
</div>
</div>
</section>
<section id="predictive-performance-on-testing-set" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="predictive-performance-on-testing-set"><span class="header-section-number">3.3</span> predictive performance on testing set</h2>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>ld_test <span class="op">=</span>predictor.leaderboard(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  data<span class="op">=</span>dl_test,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  extra_metrics<span class="op">=</span>[<span class="st">'roc_auc'</span>,<span class="st">'accuracy'</span>,<span class="st">'log_loss'</span>])</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Leaderboard on testing set'</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ld_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Leaderboard on testing set
                 model  score_test   roc_auc  accuracy  log_loss  score_val  \
0    LightGBMXT_BAG_L1    0.839626  0.839626  0.935941 -0.171658   0.839358   
1  WeightedEnsemble_L2    0.839626  0.839626  0.935941 -0.171658   0.839358   

  eval_metric  pred_time_test  pred_time_val   fit_time  \
0     roc_auc        0.497111       0.618643  35.107029   
1     roc_auc        0.500111       0.669655  35.171043   

   pred_time_test_marginal  pred_time_val_marginal  fit_time_marginal  \
0                 0.497111                0.618643          35.107029   
1                 0.003000                0.051012           0.064014   

   stack_level  can_infer  fit_order  
0            1       True          1  
1            2       True          2  </code></pre>
</div>
</div>
</section>
<section id="feature-importance-on-testing-data" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="feature-importance-on-testing-data"><span class="header-section-number">3.4</span> Feature importance on testing data</h2>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>d_feature_import <span class="op">=</span> predictor.feature_importance(dl_test)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>d_feature_import</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>These features in provided data are not utilized by the predictor and will be ignored: ['Endometriosis', 'multifetal_preg', 'chromosomal_abnormalities', 'immune_disease', 'antiphospholipid']
Computing feature importance via permutation shuffling for 15 features using 5000 rows with 5 shuffle sets...
    4.49s   = Expected runtime (0.9s per shuffle set)
    2.15s   = Actual runtime (Completed 5 of 5 shuffle sets)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">importance</th>
<th data-quarto-table-cell-role="th">stddev</th>
<th data-quarto-table-cell-role="th">p_value</th>
<th data-quarto-table-cell-role="th">n</th>
<th data-quarto-table-cell-role="th">p99_high</th>
<th data-quarto-table-cell-role="th">p99_low</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">payment_method</td>
<td>0.212888</td>
<td>0.019526</td>
<td>0.000008</td>
<td>5</td>
<td>0.253092</td>
<td>0.172684</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">PROM</td>
<td>0.054036</td>
<td>0.006239</td>
<td>0.000021</td>
<td>5</td>
<td>0.066882</td>
<td>0.041191</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">cervical_weakness</td>
<td>0.050590</td>
<td>0.012467</td>
<td>0.000409</td>
<td>5</td>
<td>0.076261</td>
<td>0.024920</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">occupation</td>
<td>0.023869</td>
<td>0.010264</td>
<td>0.003258</td>
<td>5</td>
<td>0.045001</td>
<td>0.002736</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">admission_source</td>
<td>0.016121</td>
<td>0.006884</td>
<td>0.003178</td>
<td>5</td>
<td>0.030296</td>
<td>0.001947</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">qidai</td>
<td>0.015338</td>
<td>0.005474</td>
<td>0.001655</td>
<td>5</td>
<td>0.026608</td>
<td>0.004068</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">marriage</td>
<td>0.010831</td>
<td>0.007690</td>
<td>0.017267</td>
<td>5</td>
<td>0.026665</td>
<td>-0.005003</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">elipse</td>
<td>0.007307</td>
<td>0.004359</td>
<td>0.009987</td>
<td>5</td>
<td>0.016282</td>
<td>-0.001668</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">GDM</td>
<td>0.006419</td>
<td>0.003158</td>
<td>0.005227</td>
<td>5</td>
<td>0.012922</td>
<td>-0.000083</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">admission_status</td>
<td>0.001226</td>
<td>0.002261</td>
<td>0.146027</td>
<td>5</td>
<td>0.005880</td>
<td>-0.003429</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">age</td>
<td>0.000066</td>
<td>0.000741</td>
<td>0.425899</td>
<td>5</td>
<td>0.001592</td>
<td>-0.001460</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">gestational_htn</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.500000</td>
<td>5</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">uterine_fibroids</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.500000</td>
<td>5</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">polyhydramnios</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.500000</td>
<td>5</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">ethnicity</td>
<td>-0.000052</td>
<td>0.000162</td>
<td>0.743451</td>
<td>5</td>
<td>0.000282</td>
<td>-0.000385</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>predictor.evaluate(dl_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\admin\.conda\envs\p38\lib\site-packages\sklearn\metrics\_classification.py:1471: UndefinedMetricWarning:

Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>{'roc_auc': 0.8414844125573746,
 'accuracy': 0.9361287667304193,
 'balanced_accuracy': 0.5,
 'mcc': 0.0,
 'f1': 0.0,
 'precision': 0.0,
 'recall': 0.0}</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>predictor.evaluate(dl_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\admin\.conda\envs\p38\lib\site-packages\sklearn\metrics\_classification.py:1471: UndefinedMetricWarning:

Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>{'roc_auc': 0.8396256776293871,
 'accuracy': 0.9359409132302742,
 'balanced_accuracy': 0.5,
 'mcc': 0.0,
 'f1': 0.0,
 'precision': 0.0,
 'recall': 0.0}</code></pre>
</div>
</div>
</section>
</section>
<section id="h2o-automl" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> H2O AutoML</h1>
<section id="configuring-h2o-automl" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="configuring-h2o-automl"><span class="header-section-number">4.1</span> Configuring H2O AutoML</h2>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> h2o</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> h2o.automl <span class="im">import</span> H2OAutoML</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>h2o.init()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Checking whether there is an H2O instance running at http://localhost:54321..... not found.
Attempting to start a local H2O server...
  Java Version: openjdk version "21.0.1" 2023-10-17 LTS; OpenJDK Runtime Environment Zulu21.30+15-CA (build 21.0.1+12-LTS); OpenJDK 64-Bit Server VM Zulu21.30+15-CA (build 21.0.1+12-LTS, mixed mode, sharing)
  Starting server from C:\Users\admin\.conda\envs\p38\Lib\site-packages\h2o\backend\bin\h2o.jar
  Ice root: C:\Users\admin\AppData\Local\Temp\tmp6f3r8g7b
  JVM stdout: C:\Users\admin\AppData\Local\Temp\tmp6f3r8g7b\h2o_admin_started_from_python.out
  JVM stderr: C:\Users\admin\AppData\Local\Temp\tmp6f3r8g7b\h2o_admin_started_from_python.err
  Server is running at http://127.0.0.1:54321
Connecting to H2O server at http://127.0.0.1:54321 ... successful.</code></pre>
</div>
<div class="cell-output cell-output-display">


<style>

#h2o-table-1.h2o-container {
  overflow-x: auto;
}
#h2o-table-1 .h2o-table {
  /* width: 100%; */
  margin-top: 1em;
  margin-bottom: 1em;
}
#h2o-table-1 .h2o-table caption {
  white-space: nowrap;
  caption-side: top;
  text-align: left;
  /* margin-left: 1em; */
  margin: 0;
  font-size: larger;
}
#h2o-table-1 .h2o-table thead {
  white-space: nowrap; 
  position: sticky;
  top: 0;
  box-shadow: 0 -1px inset;
}
#h2o-table-1 .h2o-table tbody {
  overflow: auto;
}
#h2o-table-1 .h2o-table th,
#h2o-table-1 .h2o-table td {
  text-align: right;
  /* border: 1px solid; */
}
#h2o-table-1 .h2o-table tr:nth-child(even) {
  /* background: #F5F5F5 */
}

</style>      
<div id="h2o-table-1" class="h2o-container">
  
<table class="h2o-table table table-sm table-striped small" data-quarto-postprocess="true">
<tbody>
<tr class="odd">
<td>H2O_cluster_uptime:</td>
<td>01 secs</td>
</tr>
<tr class="even">
<td>H2O_cluster_timezone:</td>
<td>America/Chicago</td>
</tr>
<tr class="odd">
<td>H2O_data_parsing_timezone:</td>
<td>UTC</td>
</tr>
<tr class="even">
<td>H2O_cluster_version:</td>
<td>3.44.0.2</td>
</tr>
<tr class="odd">
<td>H2O_cluster_version_age:</td>
<td>28 days, 15 hours and 12 minutes</td>
</tr>
<tr class="even">
<td>H2O_cluster_name:</td>
<td>H2O_from_python_admin_uc3fpq</td>
</tr>
<tr class="odd">
<td>H2O_cluster_total_nodes:</td>
<td>1</td>
</tr>
<tr class="even">
<td>H2O_cluster_free_memory:</td>
<td>3.462 Gb</td>
</tr>
<tr class="odd">
<td>H2O_cluster_total_cores:</td>
<td>12</td>
</tr>
<tr class="even">
<td>H2O_cluster_allowed_cores:</td>
<td>12</td>
</tr>
<tr class="odd">
<td>H2O_cluster_status:</td>
<td>locked, healthy</td>
</tr>
<tr class="even">
<td>H2O_connection_url:</td>
<td>http://127.0.0.1:54321</td>
</tr>
<tr class="odd">
<td>H2O_connection_proxy:</td>
<td>{"http": null, "https": null}</td>
</tr>
<tr class="even">
<td>H2O_internal_security:</td>
<td>False</td>
</tr>
<tr class="odd">
<td>Python_version:</td>
<td>3.9.18 final</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="convert-data-into-h2o-frames" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="convert-data-into-h2o-frames"><span class="header-section-number">4.2</span> Convert data into H2O Frames</h2>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>dl_train.columns.tolist()</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>dl_train_h2o <span class="op">=</span> h2o.H2OFrame(dl_train)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>dl_test_h2o <span class="op">=</span> h2o.H2OFrame(dl_test)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify predictors and response</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>x_var <span class="op">=</span> dl_train_h2o.columns</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>y_var <span class="op">=</span> <span class="st">"PTB"</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>x_var.remove(y_var)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co"># For binary classification, response should be a factor</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>dl_train_h2o[y_var] <span class="op">=</span> dl_train_h2o[y_var].asfactor()</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>dl_test_h2o[y_var] <span class="op">=</span> dl_test_h2o[y_var].asfactor()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Parse progress: |████████████████████████████████████████████████████████████████| (done) 100%
Parse progress: |████████████████████████████████████████████████████████████████| (done) 100%</code></pre>
</div>
</div>
</section>
<section id="train-data-using-h2o-automl" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="train-data-using-h2o-automl"><span class="header-section-number">4.3</span> Train data using H2O AutoML</h2>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up AutoML models</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>aml <span class="op">=</span> H2OAutoML(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#max_models=20, </span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  seed <span class="op">=</span> <span class="dv">714</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  max_runtime_secs <span class="op">=</span> run_time)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>aml</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>&lt;h2o.automl._estimator.H2OAutoML at 0x18cc1a62f10&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train h2o autoML models</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>aml.train(</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> x_var, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> y_var, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  training_frame <span class="op">=</span> dl_train_h2o, </span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  leaderboard_frame <span class="op">=</span> dl_test_h2o)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>AutoML progress: |
01:02:51.555: AutoML: XGBoost is not available; skipping it.
01:02:51.587: _train param, Dropping bad and constant columns: [immune_disease, chromosomal_abnormalities]

████████████
01:02:58.624: _train param, Dropping bad and constant columns: [immune_disease, chromosomal_abnormalities]

███████████████
01:03:05.728: _train param, Dropping unused columns: [immune_disease, chromosomal_abnormalities]

█████
01:03:08.41: _train param, Dropping bad and constant columns: [immune_disease, chromosomal_abnormalities]

████████
01:03:11.84: _train param, Dropping bad and constant columns: [immune_disease, chromosomal_abnormalities]

██████
01:03:13.764: _train param, Dropping bad and constant columns: [immune_disease, chromosomal_abnormalities]

████
01:03:16.358: _train param, Dropping bad and constant columns: [immune_disease, chromosomal_abnormalities]

███████
01:03:18.832: _train param, Dropping unused columns: [immune_disease, chromosomal_abnormalities]

███
01:03:20.486: _train param, Dropping unused columns: [immune_disease, chromosomal_abnormalities]

███| (done) 100%</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">

<pre style="margin: 1em 0 1em 0;">Model Details
=============
H2OGradientBoostingEstimator : Gradient Boosting Machine
Model Key: GBM_3_AutoML_1_20231207_10251
</pre>
<div style="margin: 1em 0 1em 0;">
<style>

#h2o-table-2.h2o-container {
  overflow-x: auto;
}
#h2o-table-2 .h2o-table {
  /* width: 100%; */
  margin-top: 1em;
  margin-bottom: 1em;
}
#h2o-table-2 .h2o-table caption {
  white-space: nowrap;
  caption-side: top;
  text-align: left;
  /* margin-left: 1em; */
  margin: 0;
  font-size: larger;
}
#h2o-table-2 .h2o-table thead {
  white-space: nowrap; 
  position: sticky;
  top: 0;
  box-shadow: 0 -1px inset;
}
#h2o-table-2 .h2o-table tbody {
  overflow: auto;
}
#h2o-table-2 .h2o-table th,
#h2o-table-2 .h2o-table td {
  text-align: right;
  /* border: 1px solid; */
}
#h2o-table-2 .h2o-table tr:nth-child(even) {
  /* background: #F5F5F5 */
}

</style>      
<div id="h2o-table-2" class="h2o-container">
  
<table class="h2o-table table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Model Summary:</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">number_of_trees</th>
<th data-quarto-table-cell-role="th">number_of_internal_trees</th>
<th data-quarto-table-cell-role="th">model_size_in_bytes</th>
<th data-quarto-table-cell-role="th">min_depth</th>
<th data-quarto-table-cell-role="th">max_depth</th>
<th data-quarto-table-cell-role="th">mean_depth</th>
<th data-quarto-table-cell-role="th">min_leaves</th>
<th data-quarto-table-cell-role="th">max_leaves</th>
<th data-quarto-table-cell-role="th">mean_leaves</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>36.0</td>
<td>36.0</td>
<td>75367.0</td>
<td>8.0</td>
<td>8.0</td>
<td>8.0</td>
<td>77.0</td>
<td>201.0</td>
<td>162.11111</td>
</tr>
</tbody>
</table>
<div style="margin: 1em 0 1em 0;">
<pre style="margin: 1em 0 1em 0;"><code>ModelMetricsBinomial: gbm
** Reported on train data. **

MSE: 0.04306611641555675
RMSE: 0.20752377313348164
LogLoss: 0.16464720957219983
Mean Per-Class Error: 0.25098823237013057
AUC: 0.8534445483334557
AUCPR: 0.43686007555206396
Gini: 0.7068890966669115</code></pre>
<div style="margin: 1em 0 1em 0;">
<div id="h2o-table-3" class="h2o-container">
<table class="h2o-table table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.27728095043768974</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">Error</th>
<th data-quarto-table-cell-role="th">Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>341674.0</td>
<td>9760.0</td>
<td>0.0278</td>
<td>(9760.0/351434.0)</td>
</tr>
<tr class="even">
<td>1</td>
<td>11416.0</td>
<td>12658.0</td>
<td>0.4742</td>
<td>(11416.0/24074.0)</td>
</tr>
<tr class="odd">
<td>Total</td>
<td>353090.0</td>
<td>22418.0</td>
<td>0.0564</td>
<td>(21176.0/375508.0)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div style="margin: 1em 0 1em 0;">
<div id="h2o-table-4" class="h2o-container">
<table class="h2o-table table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Maximum Metrics: Maximum metrics at their respective thresholds</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">metric</th>
<th data-quarto-table-cell-role="th">threshold</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">idx</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>max f1</td>
<td>0.2772810</td>
<td>0.5445238</td>
<td>106.0</td>
</tr>
<tr class="even">
<td>max f2</td>
<td>0.1018555</td>
<td>0.5504537</td>
<td>188.0</td>
</tr>
<tr class="odd">
<td>max f0point5</td>
<td>0.4481014</td>
<td>0.5616909</td>
<td>67.0</td>
</tr>
<tr class="even">
<td>max accuracy</td>
<td>0.4910098</td>
<td>0.9446430</td>
<td>56.0</td>
</tr>
<tr class="odd">
<td>max precision</td>
<td>0.6882052</td>
<td>0.8688525</td>
<td>1.0</td>
</tr>
<tr class="even">
<td>max recall</td>
<td>0.0080812</td>
<td>1.0</td>
<td>390.0</td>
</tr>
<tr class="odd">
<td>max specificity</td>
<td>0.6956044</td>
<td>0.9999516</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>max absolute_mcc</td>
<td>0.3380996</td>
<td>0.5149070</td>
<td>92.0</td>
</tr>
<tr class="odd">
<td>max min_per_class_accuracy</td>
<td>0.0379226</td>
<td>0.7613193</td>
<td>275.0</td>
</tr>
<tr class="even">
<td>max mean_per_class_accuracy</td>
<td>0.0528347</td>
<td>0.7761035</td>
<td>243.0</td>
</tr>
<tr class="odd">
<td>max tns</td>
<td>0.6956044</td>
<td>351417.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>max fns</td>
<td>0.6956044</td>
<td>23967.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>max fps</td>
<td>0.0042160</td>
<td>351434.0</td>
<td>399.0</td>
</tr>
<tr class="even">
<td>max tps</td>
<td>0.0080812</td>
<td>24074.0</td>
<td>390.0</td>
</tr>
<tr class="odd">
<td>max tnr</td>
<td>0.6956044</td>
<td>0.9999516</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>max fnr</td>
<td>0.6956044</td>
<td>0.9955554</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>max fpr</td>
<td>0.0042160</td>
<td>1.0</td>
<td>399.0</td>
</tr>
<tr class="even">
<td>max tpr</td>
<td>0.0080812</td>
<td>1.0</td>
<td>390.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div style="margin: 1em 0 1em 0;">
<div id="h2o-table-5" class="h2o-container">
<table class="h2o-table table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Gains/Lift Table: Avg response rate: 6.41 %, avg score: 6.43 %</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">group</th>
<th data-quarto-table-cell-role="th">cumulative_data_fraction</th>
<th data-quarto-table-cell-role="th">lower_threshold</th>
<th data-quarto-table-cell-role="th">lift</th>
<th data-quarto-table-cell-role="th">cumulative_lift</th>
<th data-quarto-table-cell-role="th">response_rate</th>
<th data-quarto-table-cell-role="th">score</th>
<th data-quarto-table-cell-role="th">cumulative_response_rate</th>
<th data-quarto-table-cell-role="th">cumulative_score</th>
<th data-quarto-table-cell-role="th">capture_rate</th>
<th data-quarto-table-cell-role="th">cumulative_capture_rate</th>
<th data-quarto-table-cell-role="th">gain</th>
<th data-quarto-table-cell-role="th">cumulative_gain</th>
<th data-quarto-table-cell-role="th">kolmogorov_smirnov</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0.0103407</td>
<td>0.5767415</td>
<td>10.0746758</td>
<td>10.0746758</td>
<td>0.6458924</td>
<td>0.5874826</td>
<td>0.6458924</td>
<td>0.5874826</td>
<td>0.1041788</td>
<td>0.1041788</td>
<td>907.4675793</td>
<td>907.4675793</td>
<td>0.1002662</td>
</tr>
<tr class="even">
<td>2</td>
<td>0.0213604</td>
<td>0.5671697</td>
<td>9.2804386</td>
<td>9.6649322</td>
<td>0.5949734</td>
<td>0.5714111</td>
<td>0.6196235</td>
<td>0.5791914</td>
<td>0.1022680</td>
<td>0.2064468</td>
<td>828.0438561</td>
<td>866.4932162</td>
<td>0.1977652</td>
</tr>
<tr class="odd">
<td>3</td>
<td>0.0319327</td>
<td>0.5553938</td>
<td>9.0052349</td>
<td>9.4465185</td>
<td>0.5773300</td>
<td>0.5606879</td>
<td>0.6056209</td>
<td>0.5730652</td>
<td>0.0952064</td>
<td>0.3016532</td>
<td>800.5234867</td>
<td>844.6518496</td>
<td>0.2881969</td>
</tr>
<tr class="even">
<td>4</td>
<td>0.0404652</td>
<td>0.5454813</td>
<td>8.6802008</td>
<td>9.2849336</td>
<td>0.5564919</td>
<td>0.5478404</td>
<td>0.5952616</td>
<td>0.5677463</td>
<td>0.0740633</td>
<td>0.3757165</td>
<td>768.0200831</td>
<td>828.4933646</td>
<td>0.3582168</td>
</tr>
<tr class="odd">
<td>5</td>
<td>0.0502280</td>
<td>0.5299292</td>
<td>8.5180964</td>
<td>9.1358840</td>
<td>0.5460993</td>
<td>0.5404406</td>
<td>0.5857060</td>
<td>0.5624389</td>
<td>0.0831603</td>
<td>0.4588768</td>
<td>751.8096390</td>
<td>813.5884000</td>
<td>0.4366422</td>
</tr>
<tr class="even">
<td>6</td>
<td>0.1404737</td>
<td>0.0703466</td>
<td>2.1720758</td>
<td>4.6620640</td>
<td>0.1392528</td>
<td>0.1328685</td>
<td>0.2988872</td>
<td>0.2864663</td>
<td>0.1960206</td>
<td>0.6548974</td>
<td>117.2075798</td>
<td>366.2063978</td>
<td>0.5496628</td>
</tr>
<tr class="odd">
<td>7</td>
<td>0.1603961</td>
<td>0.0660954</td>
<td>1.1029783</td>
<td>4.2199999</td>
<td>0.0707125</td>
<td>0.0667604</td>
<td>0.2705462</td>
<td>0.2591772</td>
<td>0.0219739</td>
<td>0.6768713</td>
<td>10.2978266</td>
<td>321.9999887</td>
<td>0.5518550</td>
</tr>
<tr class="even">
<td>8</td>
<td>0.2043072</td>
<td>0.0491889</td>
<td>0.9412385</td>
<td>3.5153049</td>
<td>0.0603433</td>
<td>0.0555390</td>
<td>0.2253679</td>
<td>0.2154098</td>
<td>0.0413309</td>
<td>0.7182022</td>
<td>-5.8761462</td>
<td>251.5304884</td>
<td>0.5490979</td>
</tr>
<tr class="odd">
<td>9</td>
<td>0.3098656</td>
<td>0.0373260</td>
<td>0.6382783</td>
<td>2.5352213</td>
<td>0.0409203</td>
<td>0.0409377</td>
<td>0.1625343</td>
<td>0.1559744</td>
<td>0.0673756</td>
<td>0.7855778</td>
<td>-36.1721737</td>
<td>153.5221338</td>
<td>0.5082996</td>
</tr>
<tr class="even">
<td>10</td>
<td>0.4364994</td>
<td>0.0365575</td>
<td>0.5569803</td>
<td>1.9613095</td>
<td>0.0357083</td>
<td>0.0365688</td>
<td>0.1257405</td>
<td>0.1213334</td>
<td>0.0705325</td>
<td>0.8561103</td>
<td>-44.3019699</td>
<td>96.1309486</td>
<td>0.4483552</td>
</tr>
<tr class="odd">
<td>11</td>
<td>0.5135230</td>
<td>0.0310797</td>
<td>0.5225783</td>
<td>1.7455132</td>
<td>0.0335027</td>
<td>0.0334416</td>
<td>0.1119057</td>
<td>0.1081504</td>
<td>0.0402509</td>
<td>0.8963612</td>
<td>-47.7421694</td>
<td>74.5513239</td>
<td>0.4090635</td>
</tr>
<tr class="even">
<td>12</td>
<td>0.6029965</td>
<td>0.0259488</td>
<td>0.4015814</td>
<td>1.5460988</td>
<td>0.0257456</td>
<td>0.0279489</td>
<td>0.0991211</td>
<td>0.0962500</td>
<td>0.0359309</td>
<td>0.9322921</td>
<td>-59.8418572</td>
<td>54.6098757</td>
<td>0.3518531</td>
</tr>
<tr class="odd">
<td>13</td>
<td>0.7007014</td>
<td>0.0199743</td>
<td>0.3201327</td>
<td>1.3751515</td>
<td>0.0205239</td>
<td>0.0229059</td>
<td>0.0881616</td>
<td>0.0860230</td>
<td>0.0312786</td>
<td>0.9635707</td>
<td>-67.9867299</td>
<td>37.5151511</td>
<td>0.2808763</td>
</tr>
<tr class="even">
<td>14</td>
<td>0.7999989</td>
<td>0.0151613</td>
<td>0.2175288</td>
<td>1.2314650</td>
<td>0.0139459</td>
<td>0.0184224</td>
<td>0.0789498</td>
<td>0.0776323</td>
<td>0.0216001</td>
<td>0.9851707</td>
<td>-78.2471163</td>
<td>23.1465044</td>
<td>0.1978565</td>
</tr>
<tr class="odd">
<td>15</td>
<td>0.9000394</td>
<td>0.0107082</td>
<td>0.1025588</td>
<td>1.1059857</td>
<td>0.0065751</td>
<td>0.0127270</td>
<td>0.0709053</td>
<td>0.0704180</td>
<td>0.0102600</td>
<td>0.9954308</td>
<td>-89.7441199</td>
<td>10.5985739</td>
<td>0.1019259</td>
</tr>
<tr class="even">
<td>16</td>
<td>1.0</td>
<td>0.0029360</td>
<td>0.0457105</td>
<td>1.0</td>
<td>0.0029305</td>
<td>0.0093687</td>
<td>0.0641105</td>
<td>0.0643154</td>
<td>0.0045692</td>
<td>1.0</td>
<td>-95.4289536</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div style="margin: 1em 0 1em 0;">
<pre style="margin: 1em 0 1em 0;"><code>ModelMetricsBinomial: gbm
** Reported on validation data. **

MSE: 0.043917391017974886
RMSE: 0.20956476568825896
LogLoss: 0.16898724215122973
Mean Per-Class Error: 0.25724701296342833
AUC: 0.8363505574612703
AUCPR: 0.4169969311226357
Gini: 0.6727011149225406</code></pre>
<div style="margin: 1em 0 1em 0;">
<div id="h2o-table-6" class="h2o-container">
<table class="h2o-table table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Confusion Matrix (Act/Pred) for max f1 @ threshold = 0.3280048994499867</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">Error</th>
<th data-quarto-table-cell-role="th">Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>49291.0</td>
<td>1413.0</td>
<td>0.0279</td>
<td>(1413.0/50704.0)</td>
</tr>
<tr class="even">
<td>1</td>
<td>1692.0</td>
<td>1785.0</td>
<td>0.4866</td>
<td>(1692.0/3477.0)</td>
</tr>
<tr class="odd">
<td>Total</td>
<td>50983.0</td>
<td>3198.0</td>
<td>0.0573</td>
<td>(3105.0/54181.0)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div style="margin: 1em 0 1em 0;">
<div id="h2o-table-7" class="h2o-container">
<table class="h2o-table table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Maximum Metrics: Maximum metrics at their respective thresholds</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">metric</th>
<th data-quarto-table-cell-role="th">threshold</th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">idx</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>max f1</td>
<td>0.3280049</td>
<td>0.5348315</td>
<td>95.0</td>
</tr>
<tr class="even">
<td>max f2</td>
<td>0.1112541</td>
<td>0.5341189</td>
<td>176.0</td>
</tr>
<tr class="odd">
<td>max f0point5</td>
<td>0.4304968</td>
<td>0.5536497</td>
<td>72.0</td>
</tr>
<tr class="even">
<td>max accuracy</td>
<td>0.5100752</td>
<td>0.9436334</td>
<td>53.0</td>
</tr>
<tr class="odd">
<td>max precision</td>
<td>0.6869649</td>
<td>0.9583333</td>
<td>2.0</td>
</tr>
<tr class="even">
<td>max recall</td>
<td>0.0083318</td>
<td>1.0</td>
<td>387.0</td>
</tr>
<tr class="odd">
<td>max specificity</td>
<td>0.6956007</td>
<td>0.9999803</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>max absolute_mcc</td>
<td>0.3655213</td>
<td>0.5050797</td>
<td>89.0</td>
</tr>
<tr class="odd">
<td>max min_per_class_accuracy</td>
<td>0.0377351</td>
<td>0.7478897</td>
<td>275.0</td>
</tr>
<tr class="even">
<td>max mean_per_class_accuracy</td>
<td>0.0570325</td>
<td>0.7663964</td>
<td>235.0</td>
</tr>
<tr class="odd">
<td>max tns</td>
<td>0.6956007</td>
<td>50703.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>max fns</td>
<td>0.6956007</td>
<td>3464.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>max fps</td>
<td>0.0039980</td>
<td>50704.0</td>
<td>399.0</td>
</tr>
<tr class="even">
<td>max tps</td>
<td>0.0083318</td>
<td>3477.0</td>
<td>387.0</td>
</tr>
<tr class="odd">
<td>max tnr</td>
<td>0.6956007</td>
<td>0.9999803</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>max fnr</td>
<td>0.6956007</td>
<td>0.9962611</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>max fpr</td>
<td>0.0039980</td>
<td>1.0</td>
<td>399.0</td>
</tr>
<tr class="even">
<td>max tpr</td>
<td>0.0083318</td>
<td>1.0</td>
<td>387.0</td>
</tr>
</tbody>
</table>
</div>
</div>
<div style="margin: 1em 0 1em 0;">
<div id="h2o-table-8" class="h2o-container">
<table class="h2o-table table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Gains/Lift Table: Avg response rate: 6.42 %, avg score: 6.44 %</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">group</th>
<th data-quarto-table-cell-role="th">cumulative_data_fraction</th>
<th data-quarto-table-cell-role="th">lower_threshold</th>
<th data-quarto-table-cell-role="th">lift</th>
<th data-quarto-table-cell-role="th">cumulative_lift</th>
<th data-quarto-table-cell-role="th">response_rate</th>
<th data-quarto-table-cell-role="th">score</th>
<th data-quarto-table-cell-role="th">cumulative_response_rate</th>
<th data-quarto-table-cell-role="th">cumulative_score</th>
<th data-quarto-table-cell-role="th">capture_rate</th>
<th data-quarto-table-cell-role="th">cumulative_capture_rate</th>
<th data-quarto-table-cell-role="th">gain</th>
<th data-quarto-table-cell-role="th">cumulative_gain</th>
<th data-quarto-table-cell-role="th">kolmogorov_smirnov</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0.0105941</td>
<td>0.5767415</td>
<td>9.6373756</td>
<td>9.6373756</td>
<td>0.6184669</td>
<td>0.5861493</td>
<td>0.6184669</td>
<td>0.5861493</td>
<td>0.1020995</td>
<td>0.1020995</td>
<td>863.7375626</td>
<td>863.7375626</td>
<td>0.0977803</td>
</tr>
<tr class="even">
<td>2</td>
<td>0.0201178</td>
<td>0.5699732</td>
<td>9.0295023</td>
<td>9.3496117</td>
<td>0.5794574</td>
<td>0.5723470</td>
<td>0.6</td>
<td>0.5796153</td>
<td>0.0859937</td>
<td>0.1880932</td>
<td>802.9502289</td>
<td>834.9611734</td>
<td>0.1794943</td>
</tr>
<tr class="odd">
<td>3</td>
<td>0.0330743</td>
<td>0.5553938</td>
<td>9.0122088</td>
<td>9.2174372</td>
<td>0.5783476</td>
<td>0.5617594</td>
<td>0.5915179</td>
<td>0.5726204</td>
<td>0.1167673</td>
<td>0.3048605</td>
<td>801.2208842</td>
<td>821.7437164</td>
<td>0.2904238</td>
</tr>
<tr class="even">
<td>4</td>
<td>0.0414167</td>
<td>0.5454813</td>
<td>8.5153175</td>
<td>9.0760120</td>
<td>0.5464602</td>
<td>0.5478381</td>
<td>0.5824421</td>
<td>0.5676286</td>
<td>0.0710383</td>
<td>0.3758988</td>
<td>751.5317472</td>
<td>807.6011985</td>
<td>0.3574190</td>
</tr>
<tr class="odd">
<td>5</td>
<td>0.0502390</td>
<td>0.5299292</td>
<td>8.3129393</td>
<td>8.9420117</td>
<td>0.5334728</td>
<td>0.5403453</td>
<td>0.5738428</td>
<td>0.5628375</td>
<td>0.0733391</td>
<td>0.4492378</td>
<td>731.2939303</td>
<td>794.2011713</td>
<td>0.4263600</td>
</tr>
<tr class="even">
<td>6</td>
<td>0.1010871</td>
<td>0.0705899</td>
<td>2.8167614</td>
<td>5.8609337</td>
<td>0.1807623</td>
<td>0.1803820</td>
<td>0.3761183</td>
<td>0.3704576</td>
<td>0.1432269</td>
<td>0.5924648</td>
<td>181.6761430</td>
<td>486.0933654</td>
<td>0.5250736</td>
</tr>
<tr class="odd">
<td>7</td>
<td>0.1500341</td>
<td>0.0669974</td>
<td>1.0811517</td>
<td>4.3015805</td>
<td>0.0693816</td>
<td>0.0699321</td>
<td>0.2760487</td>
<td>0.2724143</td>
<td>0.0529192</td>
<td>0.6453840</td>
<td>8.1151684</td>
<td>330.1580500</td>
<td>0.5293182</td>
</tr>
<tr class="even">
<td>8</td>
<td>0.2003839</td>
<td>0.0492183</td>
<td>0.9939103</td>
<td>3.4704739</td>
<td>0.0637830</td>
<td>0.0587209</td>
<td>0.2227135</td>
<td>0.2187203</td>
<td>0.0500431</td>
<td>0.6954271</td>
<td>-0.6089662</td>
<td>247.0473914</td>
<td>0.5289905</td>
</tr>
<tr class="odd">
<td>9</td>
<td>0.3001606</td>
<td>0.0373517</td>
<td>0.6139682</td>
<td>2.5209400</td>
<td>0.0394007</td>
<td>0.0417434</td>
<td>0.1617783</td>
<td>0.1598912</td>
<td>0.0612597</td>
<td>0.7566868</td>
<td>-38.6031786</td>
<td>152.0940014</td>
<td>0.4878323</td>
</tr>
<tr class="even">
<td>10</td>
<td>0.4367583</td>
<td>0.0365575</td>
<td>0.5326874</td>
<td>1.8991070</td>
<td>0.0341846</td>
<td>0.0366220</td>
<td>0.1218729</td>
<td>0.1213384</td>
<td>0.0727639</td>
<td>0.8294507</td>
<td>-46.7312577</td>
<td>89.9106959</td>
<td>0.4196211</td>
</tr>
<tr class="odd">
<td>11</td>
<td>0.5138333</td>
<td>0.0310797</td>
<td>0.5597229</td>
<td>1.6981994</td>
<td>0.0359195</td>
<td>0.0334265</td>
<td>0.1089799</td>
<td>0.1081516</td>
<td>0.0431406</td>
<td>0.8725913</td>
<td>-44.0277075</td>
<td>69.8199354</td>
<td>0.3833597</td>
</tr>
<tr class="even">
<td>12</td>
<td>0.6023514</td>
<td>0.0259488</td>
<td>0.4256322</td>
<td>1.5111902</td>
<td>0.0273144</td>
<td>0.0279846</td>
<td>0.0969788</td>
<td>0.0963707</td>
<td>0.0376762</td>
<td>0.9102675</td>
<td>-57.4367828</td>
<td>51.1190155</td>
<td>0.3290313</td>
</tr>
<tr class="odd">
<td>13</td>
<td>0.7012606</td>
<td>0.0199743</td>
<td>0.4129019</td>
<td>1.3562822</td>
<td>0.0264975</td>
<td>0.0229164</td>
<td>0.0870378</td>
<td>0.0860103</td>
<td>0.0408398</td>
<td>0.9511073</td>
<td>-58.7098070</td>
<td>35.6282230</td>
<td>0.2669798</td>
</tr>
<tr class="even">
<td>14</td>
<td>0.8001698</td>
<td>0.0154797</td>
<td>0.2704217</td>
<td>1.2220587</td>
<td>0.0173540</td>
<td>0.0185122</td>
<td>0.0784241</td>
<td>0.0776669</td>
<td>0.0267472</td>
<td>0.9778545</td>
<td>-72.9578313</td>
<td>22.2058706</td>
<td>0.1898693</td>
</tr>
<tr class="odd">
<td>15</td>
<td>0.9000018</td>
<td>0.0107647</td>
<td>0.1382823</td>
<td>1.1018416</td>
<td>0.0088741</td>
<td>0.0128262</td>
<td>0.0707093</td>
<td>0.0704745</td>
<td>0.0138050</td>
<td>0.9916595</td>
<td>-86.1717704</td>
<td>10.1841603</td>
<td>0.0979430</td>
</tr>
<tr class="even">
<td>16</td>
<td>1.0</td>
<td>0.0037286</td>
<td>0.0834068</td>
<td>1.0</td>
<td>0.0053525</td>
<td>0.0093751</td>
<td>0.0641738</td>
<td>0.0643646</td>
<td>0.0083405</td>
<td>1.0</td>
<td>-91.6593226</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div style="margin: 1em 0 1em 0;">
<div id="h2o-table-9" class="h2o-container">
<table class="h2o-table table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Scoring History:</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">timestamp</th>
<th data-quarto-table-cell-role="th">duration</th>
<th data-quarto-table-cell-role="th">number_of_trees</th>
<th data-quarto-table-cell-role="th">training_rmse</th>
<th data-quarto-table-cell-role="th">training_logloss</th>
<th data-quarto-table-cell-role="th">training_auc</th>
<th data-quarto-table-cell-role="th">training_pr_auc</th>
<th data-quarto-table-cell-role="th">training_lift</th>
<th data-quarto-table-cell-role="th">training_classification_error</th>
<th data-quarto-table-cell-role="th">validation_rmse</th>
<th data-quarto-table-cell-role="th">validation_logloss</th>
<th data-quarto-table-cell-role="th">validation_auc</th>
<th data-quarto-table-cell-role="th">validation_pr_auc</th>
<th data-quarto-table-cell-role="th">validation_lift</th>
<th data-quarto-table-cell-role="th">validation_classification_error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td>2023-12-07 01:03:13</td>
<td>0.004 sec</td>
<td>0.0</td>
<td>0.2449496</td>
<td>0.2381310</td>
<td>0.5</td>
<td>0.0641105</td>
<td>1.0</td>
<td>0.9358895</td>
<td>0.2450623</td>
<td>0.2383007</td>
<td>0.5</td>
<td>0.0641738</td>
<td>1.0</td>
<td>0.9358262</td>
</tr>
<tr class="even">
<td></td>
<td>2023-12-07 01:03:14</td>
<td>0.295 sec</td>
<td>5.0</td>
<td>0.2210147</td>
<td>0.1861969</td>
<td>0.8416603</td>
<td>0.4023719</td>
<td>8.9466166</td>
<td>0.0571599</td>
<td>0.2217754</td>
<td>0.1877250</td>
<td>0.8300999</td>
<td>0.3901436</td>
<td>8.7900956</td>
<td>0.0580646</td>
</tr>
<tr class="odd">
<td></td>
<td>2023-12-07 01:03:14</td>
<td>0.608 sec</td>
<td>10.0</td>
<td>0.2130115</td>
<td>0.1744744</td>
<td>0.8444586</td>
<td>0.4061689</td>
<td>8.9645996</td>
<td>0.0562731</td>
<td>0.2141905</td>
<td>0.1767496</td>
<td>0.8314111</td>
<td>0.3923180</td>
<td>8.7965024</td>
<td>0.0571972</td>
</tr>
<tr class="even">
<td></td>
<td>2023-12-07 01:03:14</td>
<td>0.911 sec</td>
<td>15.0</td>
<td>0.2105115</td>
<td>0.1704670</td>
<td>0.8475966</td>
<td>0.4264973</td>
<td>9.4414943</td>
<td>0.0564995</td>
<td>0.2119033</td>
<td>0.1731991</td>
<td>0.8328763</td>
<td>0.4117079</td>
<td>9.2300567</td>
<td>0.0572341</td>
</tr>
<tr class="odd">
<td></td>
<td>2023-12-07 01:03:14</td>
<td>1.219 sec</td>
<td>20.0</td>
<td>0.2087794</td>
<td>0.1675861</td>
<td>0.8498463</td>
<td>0.4296539</td>
<td>9.5130415</td>
<td>0.0563610</td>
<td>0.2104077</td>
<td>0.1708383</td>
<td>0.8344017</td>
<td>0.4125823</td>
<td>9.2275596</td>
<td>0.0571418</td>
</tr>
<tr class="even">
<td></td>
<td>2023-12-07 01:03:15</td>
<td>1.528 sec</td>
<td>25.0</td>
<td>0.2080978</td>
<td>0.1662065</td>
<td>0.8506801</td>
<td>0.4325922</td>
<td>9.6535980</td>
<td>0.0563663</td>
<td>0.2098768</td>
<td>0.1698186</td>
<td>0.8350244</td>
<td>0.4159679</td>
<td>9.5071895</td>
<td>0.0570864</td>
</tr>
<tr class="odd">
<td></td>
<td>2023-12-07 01:03:15</td>
<td>1.839 sec</td>
<td>30.0</td>
<td>0.2077527</td>
<td>0.1653148</td>
<td>0.8523930</td>
<td>0.4353824</td>
<td>9.9507411</td>
<td>0.0563104</td>
<td>0.2096857</td>
<td>0.1693167</td>
<td>0.8354700</td>
<td>0.4154898</td>
<td>9.4079556</td>
<td>0.0570495</td>
</tr>
<tr class="even">
<td></td>
<td>2023-12-07 01:03:15</td>
<td>2.149 sec</td>
<td>35.0</td>
<td>0.2075458</td>
<td>0.1647165</td>
<td>0.8533094</td>
<td>0.4362890</td>
<td>10.0477199</td>
<td>0.0563983</td>
<td>0.2095751</td>
<td>0.1690224</td>
<td>0.8362343</td>
<td>0.4165016</td>
<td>9.5913234</td>
<td>0.0570864</td>
</tr>
<tr class="odd">
<td></td>
<td>2023-12-07 01:03:16</td>
<td>2.256 sec</td>
<td>36.0</td>
<td>0.2075238</td>
<td>0.1646472</td>
<td>0.8534445</td>
<td>0.4368601</td>
<td>10.0746758</td>
<td>0.0563929</td>
<td>0.2095648</td>
<td>0.1689872</td>
<td>0.8363506</td>
<td>0.4169969</td>
<td>9.6373756</td>
<td>0.0573079</td>
</tr>
</tbody>
</table>
</div>
</div>
<div style="margin: 1em 0 1em 0;">
<div id="h2o-table-10" class="h2o-container">
<table class="h2o-table table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Variable Importances:</caption>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">variable</th>
<th data-quarto-table-cell-role="th">relative_importance</th>
<th data-quarto-table-cell-role="th">scaled_importance</th>
<th data-quarto-table-cell-role="th">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>payment_method</td>
<td>17400.4550781</td>
<td>1.0</td>
<td>0.6769733</td>
</tr>
<tr class="even">
<td>occupation</td>
<td>2692.9626465</td>
<td>0.1547639</td>
<td>0.1047710</td>
</tr>
<tr class="odd">
<td>marriage</td>
<td>1322.8864746</td>
<td>0.0760260</td>
<td>0.0514676</td>
</tr>
<tr class="even">
<td>admission_source</td>
<td>1166.2537842</td>
<td>0.0670243</td>
<td>0.0453737</td>
</tr>
<tr class="odd">
<td>PROM</td>
<td>962.8132324</td>
<td>0.0553326</td>
<td>0.0374587</td>
</tr>
<tr class="even">
<td>cervical_weakness</td>
<td>846.3294678</td>
<td>0.0486384</td>
<td>0.0329269</td>
</tr>
<tr class="odd">
<td>age</td>
<td>324.8121643</td>
<td>0.0186669</td>
<td>0.0126370</td>
</tr>
<tr class="even">
<td>GDM</td>
<td>316.0144348</td>
<td>0.0181613</td>
<td>0.0122947</td>
</tr>
<tr class="odd">
<td>qidai</td>
<td>268.6200867</td>
<td>0.0154375</td>
<td>0.0104508</td>
</tr>
<tr class="even">
<td>elipse</td>
<td>229.7005157</td>
<td>0.0132008</td>
<td>0.0089366</td>
</tr>
<tr class="odd">
<td>admission_status</td>
<td>154.2435913</td>
<td>0.0088643</td>
<td>0.0060009</td>
</tr>
<tr class="even">
<td>ethnicity</td>
<td>10.5084848</td>
<td>0.0006039</td>
<td>0.0004088</td>
</tr>
<tr class="odd">
<td>polyhydramnios</td>
<td>7.7089119</td>
<td>0.0004430</td>
<td>0.0002999</td>
</tr>
<tr class="even">
<td>gestational_htn</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>uterine_fibroids</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>Endometriosis</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td>multifetal_preg</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr class="even">
<td>antiphospholipid</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
</div><pre style="font-size: smaller; margin: 1em 0 0 0;">
[tips]
Use `model.explain()` to inspect the model.
--
Use `h2o.display.toggle_user_tips()` to switch on/off this section.</pre>
</div>
</div>
</section>
<section id="leaderboard" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="leaderboard"><span class="header-section-number">4.4</span> Leaderboard</h2>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>lb <span class="op">=</span> h2o.automl.get_leaderboard(aml, extra_columns <span class="op">=</span> <span class="st">"ALL"</span>).as_data_frame()</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>lb</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">model_id</th>
<th data-quarto-table-cell-role="th">auc</th>
<th data-quarto-table-cell-role="th">logloss</th>
<th data-quarto-table-cell-role="th">aucpr</th>
<th data-quarto-table-cell-role="th">mean_per_class_error</th>
<th data-quarto-table-cell-role="th">rmse</th>
<th data-quarto-table-cell-role="th">mse</th>
<th data-quarto-table-cell-role="th">training_time_ms</th>
<th data-quarto-table-cell-role="th">predict_time_per_row_ms</th>
<th data-quarto-table-cell-role="th">algo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>GBM_3_AutoML_1_20231207_10251</td>
<td>0.844989</td>
<td>0.166647</td>
<td>0.422263</td>
<td>0.252257</td>
<td>0.208305</td>
<td>0.043391</td>
<td>2319</td>
<td>0.001412</td>
<td>GBM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>StackedEnsemble_AllModels_1_AutoML_1_20231207_...</td>
<td>0.844955</td>
<td>0.166362</td>
<td>0.423128</td>
<td>0.252553</td>
<td>0.208225</td>
<td>0.043358</td>
<td>1445</td>
<td>0.004311</td>
<td>StackedEnsemble</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>GBM_2_AutoML_1_20231207_10251</td>
<td>0.844902</td>
<td>0.166657</td>
<td>0.424377</td>
<td>0.252764</td>
<td>0.208288</td>
<td>0.043384</td>
<td>2401</td>
<td>0.001628</td>
<td>GBM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>StackedEnsemble_BestOfFamily_2_AutoML_1_202312...</td>
<td>0.844659</td>
<td>0.166516</td>
<td>0.422301</td>
<td>0.252556</td>
<td>0.208282</td>
<td>0.043382</td>
<td>1287</td>
<td>0.001613</td>
<td>StackedEnsemble</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>StackedEnsemble_BestOfFamily_1_AutoML_1_202312...</td>
<td>0.843657</td>
<td>0.166609</td>
<td>0.422061</td>
<td>0.252409</td>
<td>0.208328</td>
<td>0.043401</td>
<td>1806</td>
<td>0.002325</td>
<td>StackedEnsemble</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>GBM_4_AutoML_1_20231207_10251</td>
<td>0.843477</td>
<td>0.167129</td>
<td>0.422897</td>
<td>0.252199</td>
<td>0.208495</td>
<td>0.043470</td>
<td>2199</td>
<td>0.001263</td>
<td>GBM</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>GBM_1_AutoML_1_20231207_10251</td>
<td>0.843139</td>
<td>0.166685</td>
<td>0.422017</td>
<td>0.251821</td>
<td>0.208332</td>
<td>0.043402</td>
<td>6584</td>
<td>0.002408</td>
<td>GBM</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>DRF_1_AutoML_1_20231207_10251</td>
<td>0.839693</td>
<td>0.168352</td>
<td>0.418313</td>
<td>0.254257</td>
<td>0.208763</td>
<td>0.043582</td>
<td>2758</td>
<td>0.000974</td>
<td>DRF</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>GLM_1_AutoML_1_20231207_10251</td>
<td>0.822632</td>
<td>0.174773</td>
<td>0.369576</td>
<td>0.248759</td>
<td>0.213153</td>
<td>0.045434</td>
<td>6540</td>
<td>0.000254</td>
<td>GLM</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="turn-off-h2o-cluster" class="level2" data-number="4.5">
<h2 data-number="4.5" class="anchored" data-anchor-id="turn-off-h2o-cluster"><span class="header-section-number">4.5</span> Turn off H2O cluster</h2>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>h2o.cluster().shutdown()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>H2O session _sid_9bed closed.</code></pre>
</div>
</div>
</section>
</section>
<section id="auto-sklearn" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Auto-sklearn</h1>
<p>Auto-sklearn requires Linux OS, since we are compiling this tutorial on a Windows machine, we only show the code and did not run the code here. The readers could copy the code and run the code in a Linux environment, with only minor modification on the data path should work.</p>
<section id="set-up-auto-sklearn-environment" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="set-up-auto-sklearn-environment"><span class="header-section-number">5.1</span> Set up auto-sklearn environment</h2>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'JOBLIB_TEMP_FOLDER'</span>] <span class="op">=</span> <span class="st">'~/autoPyTorch_tmp'</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'OMP_NUM_THREADS'</span>] <span class="op">=</span> <span class="st">'1'</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'OPENBLAS_NUM_THREADS'</span>] <span class="op">=</span> <span class="st">'8'</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>os.environ[<span class="st">'MKL_NUM_THREADS'</span>] <span class="op">=</span> <span class="st">'1'</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> autosklearn</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> autosklearn.classification</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autosklearn.classification <span class="im">import</span> AutoSklearnClassifier</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autosklearn.experimental.askl2 <span class="im">import</span> AutoSklearn2Classifier</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> autosklearn.metrics <span class="im">import</span> balanced_accuracy, precision, recall, f1, roc_auc</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co">#from autoPyTorch.api.tabular_classification import TabularClassificationTask</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'autosklearn: </span><span class="sc">%s</span><span class="st">'</span> <span class="op">%</span> autosklearn.__version__)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-up-data-for-auto-sklearn" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="set-up-data-for-auto-sklearn"><span class="header-section-number">5.2</span> Set up data for auto-sklearn</h2>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> dl_train.copy().drop(<span class="st">'PTB'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>y_train <span class="op">=</span> dl_train[[<span class="st">'PTB'</span>]]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> dl_test.copy().drop(<span class="st">'PTB'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>y_test <span class="op">=</span> dl_test[[<span class="st">'PTB'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="auto-sklearn-model-fitting" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="auto-sklearn-model-fitting"><span class="header-section-number">5.3</span> Auto-sklearn model fitting</h2>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>api <span class="op">=</span> AutoSklearnClassifier(</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#eval_metric='roc_auc',</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>    time_left_for_this_task<span class="op">=</span>run_time, </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    per_run_time_limit<span class="op">=</span><span class="dv">30</span>, <span class="co"># change this based on your machine hardware </span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    n_jobs <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    max_models_on_disc <span class="op">=</span> <span class="dv">10</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    tmp_folder <span class="op">=</span> <span class="st">'Models/PTB_autosklearn'</span>,</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    memory_limit <span class="op">=</span> <span class="dv">4</span>,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    delete_tmp_folder_after_terminate <span class="op">=</span> <span class="va">False</span>,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    scoring_functions <span class="op">=</span> [roc_auc, balanced_accuracy, precision, recall, f1],</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    metric <span class="op">=</span> roc_auc,</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    seed <span class="op">=</span> <span class="dv">12</span>,</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>).fit(</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    X<span class="op">=</span>X_train,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>y_train,</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    X_test<span class="op">=</span>X_test.copy(),</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>    y_test<span class="op">=</span>y_test.copy(),</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>    dataset_name<span class="op">=</span><span class="st">'PTB_autosklearn'</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summarize-results" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="summarize-results"><span class="header-section-number">5.4</span> Summarize results</h2>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(api.show_models())</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(api.leaderboard())</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(api.automl_.runhistory_)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(api.automl_.runhistory_.data))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> run_key <span class="kw">in</span> api.automl_.runhistory_.data:</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"#########"</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(run_key)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(api.automl_.runhistory_.data[run_key])</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print statistics from search</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(api.sprint_statistics())</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(api.show_models())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Score statistics</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>api.refit(</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    X_train<span class="op">=</span>X_train,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    y_train<span class="op">=</span>y_train,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    X_test<span class="op">=</span>X_test.copy(),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    y_test<span class="op">=</span>y_test.copy(),</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    dataset_name<span class="op">=</span><span class="st">"refit"</span>,</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>y_pred <span class="op">=</span> api.predict(X_test)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>score <span class="op">=</span> api.score(y_pred, y_test)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(score)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the final ensemble built by AutoPyTorch</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(api.show_models())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>